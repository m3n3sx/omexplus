import { Machine, Part } from '../types';

const STORAGE_KEY = 'machineparts_pro_db_v6';

// Full CSV Data
const RAW_CSV_DATA = `manufacturer,model_code,year_from,year_to,engine_model,serial_range_start,serial_range_end,notes
ATLAS,140W,2010,,Deutz TCD4.1,AT140WA001,AT140WA999,"wheeled_excavator, 14500kg"
ATLAS,150W,2010,,Deutz TCD4.1,AT150WA001,AT150WA999,"wheeled_excavator, 15500kg"
ATLAS,160W,2010,,Deutz TCD6.1,AT160WA001,AT160WA999,"wheeled_excavator, 16500kg"
ATLAS,170W,2010,,Deutz TCD6.1,AT170WA001,AT170WA999,"wheeled_excavator, 17500kg"
ATLAS,180W,2010,,Deutz TCD6.1,AT180WA001,AT180WA999,"wheeled_excavator, 18500kg"
ATLAS,190W,2010,,Deutz TCD6.1,AT190WA001,AT190WA999,"wheeled_excavator, 19500kg"
ATLAS,200W,2010,,Deutz TCD7.8,AT200WA001,AT200WA999,"wheeled_excavator, 20500kg"
ATLAS,220W,2010,,Deutz TCD7.8,AT220WA001,AT220WA999,"wheeled_excavator, 22500kg"
ATLAS,260LC,2010,,Deutz TCD7.8,AT260LCA01,AT260LCA99,"excavator, 26500kg"
ATLAS,340LC,2010,,Deutz TCD12.0,AT340LCA01,AT340LCA99,"excavator, 34500kg"
ATLAS,AC 100,2015,,Deutz TCD3.6,ATAC100A01,ATAC100A99,"excavator, 10500kg"
ATLAS,AC 20U,2015,,Yanmar 3TNV76,ATAC20A001,ATAC20A999,"mini_excavator, 2050kg"
ATLAS,AC 25U,2015,,Yanmar 3TNV80F,ATAC25A001,ATAC25A999,"mini_excavator, 2600kg"
ATLAS,AC 30U,2015,,Yanmar 3TNV82A,ATAC30A001,ATAC30A999,"mini_excavator, 3100kg"
ATLAS,AC 35U,2015,,Yanmar 3TNV88F,ATAC35A001,ATAC35A999,"mini_excavator, 3600kg"
ATLAS,AC 40U,2015,,Yanmar 3TNV88F,ATAC40A001,ATAC40A999,"mini_excavator, 4100kg"
ATLAS,AC 50U,2015,,Yanmar 4TNV88,ATAC50A001,ATAC50A999,"mini_excavator, 5100kg"
ATLAS,AC 60,2015,,Yanmar 4TNV98,ATAC60A001,ATAC60A999,"excavator, 6100kg"
ATLAS,AC 80,2015,,Deutz TCD3.6,ATAC80A001,ATAC80A999,"excavator, 8200kg"
ATLAS,AR 105,2015,,Deutz TCD6.1,ATAR105A01,ATAR105A99,"wheel_loader, 9000kg"
ATLAS,AR 35,2015,,Yanmar 4TNV88,ATAR35A001,ATAR35A999,"wheel_loader, 3000kg"
ATLAS,AR 40,2015,,Yanmar 4TNV88,ATAR40A001,ATAR40A999,"wheel_loader, 3500kg"
ATLAS,AR 52D,2015,,Yanmar 4TNV98,ATAR52DA01,ATAR52DA99,"wheel_loader, 4200kg"
ATLAS,AR 52E,2018,,Yanmar 4TNV98,ATAR52EA01,ATAR52EA99,"wheel_loader, 4400kg"
ATLAS,AR 60,2015,,Deutz TCD3.6,ATAR60A001,ATAR60A999,"wheel_loader, 5000kg"
ATLAS,AR 65,2015,,Deutz TCD3.6,ATAR65A001,ATAR65A999,"wheel_loader, 5500kg"
ATLAS,AR 75,2015,,Deutz TCD3.6,ATAR75A001,ATAR75A999,"wheel_loader, 6200kg"
ATLAS,AR 80,2015,,Deutz TCD4.1,ATAR80A001,ATAR80A999,"wheel_loader, 6800kg"
ATLAS,AR 85,2015,,Deutz TCD4.1,ATAR85A001,ATAR85A999,"wheel_loader, 7200kg"
ATLAS,AR 95,2015,,Deutz TCD4.1,ATAR95A001,ATAR95A999,"wheel_loader, 8000kg"
BOBCAT,E08,2018,,Yanmar 2TNV70,B3BL11001,B3BL19999,"mini_excavator, 850kg"
BOBCAT,E10,2015,,Yanmar 2TNV70,B3BL21001,B3BL29999,"mini_excavator, 1100kg"
BOBCAT,E10z,2020,,Yanmar 2TNV70,B3BL31001,B3BL39999,"mini_excavator, 1150kg"
BOBCAT,E145,2020,,Bobcat D34,B3BT61001,B3BT69999,"excavator, 15000kg"
BOBCAT,E165,2020,,Bobcat D34,B3BT71001,B3BT79999,"excavator, 17000kg"
BOBCAT,E17,2018,,Yanmar 3TNV70,B3BM11001,B3BM19999,"mini_excavator, 1700kg"
BOBCAT,E17z,2020,,Yanmar 3TNV70,B3BM21001,B3BM29999,"mini_excavator, 1750kg"
BOBCAT,E19,2018,,Yanmar 3TNV76,B3BM31001,B3BM39999,"mini_excavator, 1900kg"
BOBCAT,E20,2015,,Yanmar 3TNV76,B3BN11001,B3BN19999,"mini_excavator, 2050kg"
BOBCAT,E20z,2020,,Yanmar 3TNV76,B3BN21001,B3BN29999,"mini_excavator, 2100kg"
BOBCAT,E26,2015,,Yanmar 3TNV80F,B3BP11001,B3BP19999,"mini_excavator, 2700kg"
BOBCAT,E27,2018,,Yanmar 3TNV80F,B3BP21001,B3BP29999,"mini_excavator, 2800kg"
BOBCAT,E27z,2020,,Yanmar 3TNV80F,B3BP31001,B3BP39999,"mini_excavator, 2850kg"
BOBCAT,E32,2015,,Yanmar 3TNV82A,B3BR11001,B3BR19999,"mini_excavator, 3300kg"
BOBCAT,E34,2018,,Yanmar 3TNV88F,B3BR21001,B3BR29999,"mini_excavator, 3500kg"
BOBCAT,E35,2015,,Yanmar 3TNV88F,B3BR31001,B3BR39999,"mini_excavator, 3600kg"
BOBCAT,E35z,2020,,Yanmar 3TNV88F,B3BR41001,B3BR49999,"mini_excavator, 3650kg"
BOBCAT,E37,2018,,Yanmar 3TNV88F,B3BR51001,B3BR59999,"mini_excavator, 3800kg"
BOBCAT,E42,2015,,Yanmar 4TNV88,B3BS11001,B3BS19999,"mini_excavator, 4300kg"
BOBCAT,E45,2015,,Yanmar 4TNV88,B3BS21001,B3BS29999,"mini_excavator, 4600kg"
BOBCAT,E50,2015,,Yanmar 4TNV88,B3BS31001,B3BS39999,"mini_excavator, 5100kg"
BOBCAT,E50z,2020,,Yanmar 4TNV88,B3BS41001,B3BS49999,"mini_excavator, 5150kg"
BOBCAT,E55,2015,,Yanmar 4TNV98,B3BS51001,B3BS59999,"mini_excavator, 5600kg"
BOBCAT,E55z,2020,,Yanmar 4TNV98,B3BS61001,B3BS69999,"mini_excavator, 5650kg"
BOBCAT,E57W,2018,,Yanmar 4TNV98,B3BS71001,B3BS79999,"wheeled_excavator, 5800kg"
BOBCAT,E60,2015,,Yanmar 4TNV98,B3BT11001,B3BT19999,"excavator, 6100kg"
BOBCAT,E62,2018,,Yanmar 4TNV98,B3BT21001,B3BT29999,"excavator, 6300kg"
BOBCAT,E80,2015,,Bobcat D24,B3BT31001,B3BT39999,"excavator, 8200kg"
BOBCAT,E85,2015,,Bobcat D24,B3BT41001,B3BT49999,"excavator, 8700kg"
BOBCAT,E88,2020,,Bobcat D24,B3BT51001,B3BT59999,"excavator, 9000kg"
BOBCAT,S100,2015,,Kubota D1105,A3NP21001,A3NP29999,"skid_steer_loader, 1800kg"
BOBCAT,S130,2015,,Kubota V2203,A3NP31001,A3NP39999,"skid_steer_loader, 2400kg"
BOBCAT,S150,2015,,Kubota V2403,A3NP41001,A3NP49999,"skid_steer_loader, 2700kg"
BOBCAT,S175,2015,,Kubota V2607,A3NP51001,A3NP59999,"skid_steer_loader, 3000kg"
BOBCAT,S185,2015,,Kubota V2607,A3NP61001,A3NP69999,"skid_steer_loader, 3200kg"
BOBCAT,S205,2015,,Kubota V3307,A3NP71001,A3NP79999,"skid_steer_loader, 3500kg"
BOBCAT,S220,2015,,Kubota V3307,A3NP81001,A3NP89999,"skid_steer_loader, 3700kg"
BOBCAT,S250,2015,,Kubota V3800,A3NP91001,A3NP99999,"skid_steer_loader, 4000kg"
BOBCAT,S300,2015,,Kubota V3800,A3NR11001,A3NR19999,"skid_steer_loader, 4300kg"
BOBCAT,S450,2018,,Kubota V2607,B3CA11001,B3CA19999,"skid_steer_loader, 2900kg"
BOBCAT,S510,2018,,Kubota V2607,B3CA21001,B3CA29999,"skid_steer_loader, 3100kg"
BOBCAT,S530,2018,,Kubota V3307,B3CA31001,B3CA39999,"skid_steer_loader, 3300kg"
BOBCAT,S550,2018,,Kubota V3307,B3CA41001,B3CA49999,"skid_steer_loader, 3500kg"
BOBCAT,S570,2018,,Kubota V3307,B3CA51001,B3CA59999,"skid_steer_loader, 3700kg"
BOBCAT,S590,2018,,Kubota V3800,B3CA61001,B3CA69999,"skid_steer_loader, 3900kg"
BOBCAT,S595,2020,,Kubota V3800,B3CA71001,B3CA79999,"skid_steer_loader, 4000kg"
BOBCAT,S630,2018,,Kubota V3800,B3CA81001,B3CA89999,"skid_steer_loader, 4200kg"
BOBCAT,S650,2018,,Kubota V3800,B3CA91001,B3CA99999,"skid_steer_loader, 4400kg"
BOBCAT,S70,2015,,Kubota D722,A3NP11001,A3NP19999,"skid_steer_loader, 1300kg"
BOBCAT,S740,2018,,Bobcat D24,B3CB11001,B3CB19999,"skid_steer_loader, 4700kg"
BOBCAT,S750,2018,,Bobcat D24,B3CB21001,B3CB29999,"skid_steer_loader, 4900kg"
BOBCAT,S770,2018,,Bobcat D24,B3CB31001,B3CB39999,"skid_steer_loader, 5100kg"
BOBCAT,S850,2018,,Bobcat D34,B3CB41001,B3CB49999,"skid_steer_loader, 5500kg"
BOBCAT,T450,2018,,Kubota V2607,B3CC11001,B3CC19999,"compact_track_loader, 3200kg"
BOBCAT,T550,2018,,Kubota V3307,B3CC21001,B3CC29999,"compact_track_loader, 3800kg"
BOBCAT,T590,2018,,Kubota V3800,B3CC31001,B3CC39999,"compact_track_loader, 4200kg"
BOBCAT,T595,2020,,Kubota V3800,B3CC41001,B3CC49999,"compact_track_loader, 4300kg"
BOBCAT,T630,2018,,Kubota V3800,B3CC51001,B3CC59999,"compact_track_loader, 4500kg"
BOBCAT,T650,2018,,Kubota V3800,B3CC61001,B3CC69999,"compact_track_loader, 4700kg"
BOBCAT,T740,2018,,Bobcat D24,B3CC71001,B3CC79999,"compact_track_loader, 5000kg"
BOBCAT,T750,2018,,Bobcat D24,B3CC81001,B3CC89999,"compact_track_loader, 5200kg"
BOBCAT,T770,2018,,Bobcat D24,B3CC91001,B3CC99999,"compact_track_loader, 5400kg"
BOBCAT,T870,2018,,Bobcat D34,B3CD11001,B3CD19999,"compact_track_loader, 5800kg"
BOBCAT,TL30.60,2018,,Deutz TCD3.6,B3TL30A001,B3TL30A999,"telehandler, 5500kg"
BOBCAT,TL30.70,2018,,Deutz TCD3.6,B3TL30B001,B3TL30B999,"telehandler, 6000kg"
BOBCAT,TL35.70,2018,,Deutz TCD3.6,B3TL35A001,B3TL35A999,"telehandler, 6500kg"
BOBCAT,TL38.70HF,2018,,Deutz TCD3.6,B3TL38A001,B3TL38A999,"telehandler, 7000kg"
BOBCAT,TL43.80HF,2018,,Deutz TCD3.6,B3TL43A001,B3TL43A999,"telehandler, 8000kg"
BOBCAT,V417,2015,,Kubota V3800,B3V417A001,B3V417A999,"telehandler, 4500kg"
BOBCAT,V519,2015,,Kubota V3800,B3V519A001,B3V519A999,"telehandler, 5000kg"
BOBCAT,V723,2015,,Bobcat D24,B3V723A001,B3V723A999,"telehandler, 5500kg"
CASE,1021G,2018,,FPT C13,NCW1021GA1,NCW1021GA9,"wheel_loader, 32500kg"
CASE,1121G,2018,,FPT C13,NCW1121GA1,NCW1121GA9,"wheel_loader, 38500kg"
CASE,121G,2018,,FPT F34,NCW121GA01,NCW121GA99,"wheel_loader, 6500kg"
CASE,1221G,2018,,FPT C16,NCW1221GA1,NCW1221GA9,"wheel_loader, 48500kg"
CASE,21G,2018,,FPT F34,NCW21GA001,NCW21GA999,"wheel_loader, 5500kg"
CASE,221G,2018,,FPT F4HE,NCW221GA01,NCW221GA99,"wheel_loader, 8500kg"
CASE,321G,2018,,FPT F4HE,NCW321GA01,NCW321GA99,"wheel_loader, 10500kg"
CASE,521G,2018,,FPT F4HE,NCW521GA01,NCW521GA99,"wheel_loader, 13500kg"
CASE,580N,2015,,FPT F4HE,NCB580NA01,NCB580NA99,"backhoe_loader, 7500kg"
CASE,580SN,2015,,FPT F4HE,NCB580SA01,NCB580SA99,"backhoe_loader, 8000kg"
CASE,580ST,2018,,FPT F4HE,NCB580TA01,NCB580TA99,"backhoe_loader, 8500kg"
CASE,590SN,2015,,FPT F4HE,NCB590SA01,NCB590SA99,"backhoe_loader, 9000kg"
CASE,590ST,2018,,FPT F4HE,NCB590TA01,NCB590TA99,"backhoe_loader, 9500kg"
CASE,621G,2018,,FPT C87,NCW621GA01,NCW621GA99,"wheel_loader, 16500kg"
CASE,695SN,2015,,FPT F4HE,NCB695SA01,NCB695SA99,"backhoe_loader, 10000kg"
CASE,695ST,2018,,FPT F4HE,NCB695TA01,NCB695TA99,"backhoe_loader, 10500kg"
CASE,721G,2018,,FPT C87,NCW721GA01,NCW721GA99,"wheel_loader, 19500kg"
CASE,821G,2018,,FPT C87,NCW821GA01,NCW821GA99,"wheel_loader, 22500kg"
CASE,921G,2018,,FPT C13,NCW921GA01,NCW921GA99,"wheel_loader, 27500kg"
CASE,CX130D,2018,,FPT F34,NCECX130A1,NCECX130A9,"excavator, 13500kg"
CASE,CX145D SR,2018,,FPT F34,NCECX145A1,NCECX145A9,"excavator, 14500kg"
CASE,CX160D,2018,,FPT F34,NCECX160A1,NCECX160A9,"excavator, 16500kg"
CASE,CX17C,2018,,Yanmar 3TNV70,NCECX17A01,NCECX17A99,"mini_excavator, 1700kg"
CASE,CX210D,2018,,FPT F4HFE613S,NCECX210A1,NCECX210A9,"excavator, 21500kg"
CASE,CX220D,2018,,FPT F4HFE613S,NCECX220A1,NCECX220A9,"excavator, 22500kg"
CASE,CX245D SR,2018,,FPT F4HFE613S,NCECX245A1,NCECX245A9,"excavator, 24500kg"
CASE,CX250D,2018,,FPT F4HFE613S,NCECX250A1,NCECX250A9,"excavator, 25500kg"
CASE,CX26C,2018,,Yanmar 3TNV82A,NCECX26A01,NCECX26A99,"mini_excavator, 2700kg"
CASE,CX300D,2018,,FPT F4HFE613T,NCECX300A1,NCECX300A9,"excavator, 30500kg"
CASE,CX33C,2018,,Yanmar 3TNV88F,NCECX33A01,NCECX33A99,"mini_excavator, 3400kg"
CASE,CX350D,2018,,FPT F4HFE613T,NCECX350A1,NCECX350A9,"excavator, 35500kg"
CASE,CX370D,2018,,FPT F4HFE613T,NCECX370A1,NCECX370A9,"excavator, 37500kg"
CASE,CX37C,2018,,Yanmar 3TNV88F,NCECX37A01,NCECX37A99,"mini_excavator, 3800kg"
CASE,CX490D,2018,,FPT Cursor 9,NCECX490A1,NCECX490A9,"excavator, 49500kg"
CASE,CX500D,2018,,FPT Cursor 9,NCECX500A1,NCECX500A9,"excavator, 50500kg"
CASE,CX57C,2018,,Yanmar 4TNV98,NCECX57A01,NCECX57A99,"mini_excavator, 5700kg"
CASE,CX750D,2018,,FPT Cursor 13,NCECX750A1,NCECX750A9,"excavator, 75000kg"
CASE,CX75C SR,2018,,FPT F34,NCECX75A01,NCECX75A99,"excavator, 7500kg"
CASE,CX800B,2015,,Isuzu 6WG1X,NCECX800A1,NCECX800A9,"excavator, 80000kg"
CATERPILLAR,301.7,2014,,Cat C1.1,LJ300001,LJ399999,"mini_excavator, 1750kg"
CATERPILLAR,302 CR,2018,,Cat C1.1,LJ500001,LJ599999,"mini_excavator, 2650kg"
CATERPILLAR,303 CR,2018,,Cat C1.7,LJ700001,LJ799999,"mini_excavator, 3500kg"
CATERPILLAR,303.5 CR,2019,,Cat C1.7,LJ800001,LJ899999,"mini_excavator, 3800kg"
CATERPILLAR,304 CR,2018,,Cat C2.4,CR400001,CR499999,"mini_excavator, 4500kg"
CATERPILLAR,305 CR,2018,,Cat C2.4,CR500001,CR599999,"mini_excavator, 5400kg"
CATERPILLAR,306 CR,2019,,Cat C2.4,CR600001,CR699999,"mini_excavator, 6200kg"
CATERPILLAR,308 CR,2018,,Cat C3.3,CR800001,CR899999,"mini_excavator, 8500kg"
CATERPILLAR,309 CR,2019,,Cat C3.3,CR900001,CR999999,"mini_excavator, 9200kg"
CATERPILLAR,310,2020,,Cat C3.3,ZCT00001,ZCT99999,"mini_excavator, 10500kg"
CATERPILLAR,313,2020,,Cat C3.6,ZCE00001,ZCE99999,"excavator, 14000kg"
CATERPILLAR,315,2020,,Cat C3.6,ZCF00001,ZCF99999,"excavator, 16000kg"
CATERPILLAR,317,2021,,Cat C4.4,ZCG00001,ZCG99999,"excavator, 18000kg"
CATERPILLAR,320,2017,,Cat C4.4,ZBH00001,ZBH99999,"excavator, 21000kg"
CATERPILLAR,320D,2007,2012,Cat C6.4,BYC00001,BYC99999,"excavator, 20400kg"
CATERPILLAR,320D2,2014,2017,Cat C4.4,TFX00001,TFX99999,"excavator, 20500kg"
CATERPILLAR,320E,2012,2017,Cat C6.4,KGF00001,KGF99999,"excavator, 20800kg"
CATERPILLAR,323,2017,,Cat C4.4,ZBJ00001,ZBJ99999,"excavator, 23500kg"
CATERPILLAR,325,2019,,Cat C7.1,ZBK00001,ZBK99999,"excavator, 25000kg"
CATERPILLAR,326,2020,,Cat C7.1,ZBL00001,ZBL99999,"excavator, 26500kg"
CATERPILLAR,330,2017,,Cat C7.1,ZBM00001,ZBM99999,"excavator, 30000kg"
CATERPILLAR,330D,2007,2012,Cat C9,DKY00001,DKY99999,"excavator, 29500kg"
CATERPILLAR,336,2017,,Cat C9.3,ZBN00001,ZBN99999,"excavator, 36000kg"
CATERPILLAR,336D,2007,2012,Cat C9,M4T00001,M4T99999,"excavator, 35500kg"
CATERPILLAR,340,2019,,Cat C9.3,ZBP00001,ZBP99999,"excavator, 40000kg"
CATERPILLAR,349,2017,,Cat C13,ZBR00001,ZBR99999,"excavator, 49000kg"
CATERPILLAR,349D,2007,2012,Cat C13,JHF00001,JHF99999,"excavator, 48500kg"
CATERPILLAR,352,2019,,Cat C13,ZBS00001,ZBS99999,"excavator, 52000kg"
CATERPILLAR,374,2017,,Cat C15,ZBT00001,ZBT99999,"excavator, 74000kg"
CATERPILLAR,390,2019,,Cat C18,ZBU00001,ZBU99999,"excavator, 90000kg"
CATERPILLAR,906M,2015,,Cat C3.3,H9M00001,H9M99999,"wheel_loader, 5500kg"
CATERPILLAR,908M,2015,,Cat C3.3,H9N00001,H9N99999,"wheel_loader, 6500kg"
CATERPILLAR,910M,2015,,Cat C4.4,H9P00001,H9P99999,"wheel_loader, 7500kg"
CATERPILLAR,914M,2015,,Cat C4.4,H9R00001,H9R99999,"wheel_loader, 8500kg"
CATERPILLAR,918M,2016,,Cat C4.4,H9S00001,H9S99999,"wheel_loader, 10000kg"
CATERPILLAR,926M,2014,,Cat C7.1,JRF00001,JRF99999,"wheel_loader, 12500kg"
CATERPILLAR,930M,2014,,Cat C7.1,JRG00001,JRG99999,"wheel_loader, 14000kg"
CATERPILLAR,938M,2014,,Cat C7.1,JRH00001,JRH99999,"wheel_loader, 16000kg"
CATERPILLAR,950H,2005,2015,Cat C7,R4A00001,R4A99999,"wheel_loader, 18000kg"
CATERPILLAR,950M,2014,,Cat C7.1,JRJ00001,JRJ99999,"wheel_loader, 18500kg"
CATERPILLAR,962M,2014,,Cat C9.3,JRK00001,JRK99999,"wheel_loader, 21000kg"
CATERPILLAR,966H,2005,2015,Cat C11,A6D00001,A6D99999,"wheel_loader, 23500kg"
CATERPILLAR,966M,2014,,Cat C9.3,JRL00001,JRL99999,"wheel_loader, 24000kg"
CATERPILLAR,972M,2014,,Cat C13,JRM00001,JRM99999,"wheel_loader, 27000kg"
CATERPILLAR,980H,2005,2015,Cat C15,KBK00001,KBK99999,"wheel_loader, 32000kg"
CATERPILLAR,980M,2014,,Cat C13,JRN00001,JRN99999,"wheel_loader, 33000kg"
CATERPILLAR,982M,2016,,Cat C15,JRP00001,JRP99999,"wheel_loader, 36000kg"
CATERPILLAR,988K,2015,,Cat C18,LHZ00001,LHZ99999,"wheel_loader, 50000kg"
CATERPILLAR,990K,2015,,Cat C27,DPL00001,DPL99999,"wheel_loader, 75000kg"
CATERPILLAR,992K,2015,,Cat C32,AXC00001,AXC99999,"wheel_loader, 100000kg"
CATERPILLAR,D10T2,2015,,Cat C27,RJT00001,RJT99999,"dozer, 66000kg"
CATERPILLAR,D11,2019,,Cat C32,WGE00001,WGE99999,"dozer, 105000kg"
CATERPILLAR,D3K2,2014,,Cat C4.4,LGT00001,LGT99999,"dozer, 8000kg"
CATERPILLAR,D4K2,2014,,Cat C4.4,LGU00001,LGU99999,"dozer, 9500kg"
CATERPILLAR,D5,2019,,Cat C7.1,KPZ00001,KPZ99999,"dozer, 14500kg"
CATERPILLAR,D5K2,2014,,Cat C4.4,LGV00001,LGV99999,"dozer, 11000kg"
CATERPILLAR,D6,2019,,Cat C9.3,WGB00001,WGB99999,"dozer, 20000kg"
CATERPILLAR,D6K2,2014,,Cat C7.1,LGW00001,LGW99999,"dozer, 13500kg"
CATERPILLAR,D6T,2005,2019,Cat C9.3,SMC00001,SMC99999,"dozer, 19500kg"
CATERPILLAR,D7,2019,,Cat C9.3,WGC00001,WGC99999,"dozer, 28000kg"
CATERPILLAR,D7E,2009,2019,Cat C9.3,MYW00001,MYW99999,"dozer, 27000kg"
CATERPILLAR,D8,2019,,Cat C15,WGD00001,WGD99999,"dozer, 39000kg"
CATERPILLAR,D8T,2005,2019,Cat C15,J8B00001,J8B99999,"dozer, 38000kg"
CATERPILLAR,D9T,2005,,Cat C18,RJS00001,RJS99999,"dozer, 49000kg"
DEVELON,DL200-7,2022,,Develon DL06P,DVWLA00001,DVWLA09999,"wheel_loader, 11200kg"
DEVELON,DL250-7,2022,,Develon DL06P,DVWLB00001,DVWLB09999,"wheel_loader, 14200kg"
DEVELON,DL300-7,2022,,Develon DL08P,DVWLC00001,DVWLC09999,"wheel_loader, 17700kg"
DEVELON,DL350-7,2022,,Develon DL08P,DVWLD00001,DVWLD09999,"wheel_loader, 20200kg"
DEVELON,DL420-7,2022,,Scania DC09,DVWLE00001,DVWLE09999,"wheel_loader, 24200kg"
DEVELON,DL450-7,2022,,Scania DC09,DVWLF00001,DVWLF09999,"wheel_loader, 27200kg"
DEVELON,DL550-7,2022,,Scania DC13,DVWLG00001,DVWLG05000,"wheel_loader, 33200kg"
DEVELON,DX140LC-7,2022,,Develon DL06P,DVCEJ00001,DVCEJ09999,"excavator, 14700kg"
DEVELON,DX165W-7,2022,,Develon DL06P,DVCEK00001,DVCEK09999,"wheeled_excavator, 17200kg"
DEVELON,DX17Z-7,2022,,Yanmar 3TNV70,DVCEA00001,DVCEA09999,"mini_excavator, 1750kg"
DEVELON,DX180LC-7,2022,,Develon DL06P,DVCEL00001,DVCEL09999,"excavator, 18700kg"
DEVELON,DX19-7,2022,,Yanmar 3TNV76,DVCEB00001,DVCEB09999,"mini_excavator, 1950kg"
DEVELON,DX225LC-7,2022,,Develon DL06P,DVCEM00001,DVCEM09999,"excavator, 23200kg"
DEVELON,DX255LC-7,2022,,Develon DL08P,DVCEN00001,DVCEN09999,"excavator, 26200kg"
DEVELON,DX27Z-7,2022,,Yanmar 3TNV80F,DVCEC00001,DVCEC09999,"mini_excavator, 2850kg"
DEVELON,DX300LC-7,2022,,Develon DL08P,DVCEP00001,DVCEP09999,"excavator, 30700kg"
DEVELON,DX340LC-7,2022,,Develon DL08P,DVCER00001,DVCER09999,"excavator, 34700kg"
DEVELON,DX35Z-7,2022,,Yanmar 3TNV88F,DVCED00001,DVCED09999,"mini_excavator, 3650kg"
DEVELON,DX380LC-7,2022,,Scania DC09,DVCES00001,DVCES09999,"excavator, 38700kg"
DEVELON,DX420LC-7,2022,,Scania DC09,DVCET00001,DVCET09999,"excavator, 42700kg"
DEVELON,DX490LC-7,2022,,Scania DC13,DVCEU00001,DVCEU09999,"excavator, 49700kg"
DEVELON,DX50Z-7,2022,,Yanmar 4TNV98,DVCEE00001,DVCEE09999,"mini_excavator, 5150kg"
DEVELON,DX520LC-7,2022,,Scania DC13,DVCEV00001,DVCEV09999,"excavator, 52700kg"
DEVELON,DX55-7,2022,,Yanmar 4TNV98,DVCEF00001,DVCEF09999,"mini_excavator, 5650kg"
DEVELON,DX62R-7,2022,,Yanmar 4TNV98,DVCEG00001,DVCEG09999,"excavator, 6350kg"
DEVELON,DX800LC-7,2022,,Scania DC16,DVCEW00001,DVCEW05000,"excavator, 80500kg"
DEVELON,DX85R-7,2022,,Develon D24,DVCEH00001,DVCEH09999,"excavator, 8700kg"
DOOSAN,DL200-5,2015,,Doosan DL06,DHWLA00001,DHWLA09999,"wheel_loader, 11000kg"
DOOSAN,DL250-5,2015,,Doosan DL06,DHWLB00001,DHWLB09999,"wheel_loader, 14000kg"
DOOSAN,DL300-5,2015,,Doosan DL08,DHWLC00001,DHWLC09999,"wheel_loader, 17500kg"
DOOSAN,DL350-5,2015,,Doosan DL08,DHWLD00001,DHWLD09999,"wheel_loader, 20000kg"
DOOSAN,DL420-5,2015,,Scania DC09,DHWLE00001,DHWLE09999,"wheel_loader, 24000kg"
DOOSAN,DL450-5,2015,,Scania DC09,DHWLF00001,DHWLF09999,"wheel_loader, 27000kg"
DOOSAN,DL550-5,2015,,Scania DC13,DHWLG00001,DHWLG05000,"wheel_loader, 33000kg"
DOOSAN,DX140LC-7,2020,,Doosan DL06P,DHKCEK0001,DHKCEK9999,"excavator, 14500kg"
DOOSAN,DX165W-7,2020,,Doosan DL06P,DHKCEL0001,DHKCEL9999,"excavator, 17000kg"
DOOSAN,DX17Z,2018,,Yanmar 3TNV70,DHKCEA0001,DHKCEA9999,"mini_excavator, 1700kg"
DOOSAN,DX180LC-7,2020,,Doosan DL06P,DHKCEM0001,DHKCEM9999,"excavator, 18500kg"
DOOSAN,DX19,2018,,Yanmar 3TNV76,DHKCEB0001,DHKCEB9999,"mini_excavator, 1900kg"
DOOSAN,DX225-5,2015,2020,Doosan DL06,DHKCEP0001,DHKCEP9999,"excavator, 22500kg"
DOOSAN,DX225LC-7,2020,,Doosan DL06P,DHKCEN0001,DHKCEN9999,"excavator, 23000kg"
DOOSAN,DX255LC-7,2020,,Doosan DL08P,DHKCER0001,DHKCER9999,"excavator, 26000kg"
DOOSAN,DX27Z,2018,,Yanmar 3TNV82A,DHKCEC0001,DHKCEC9999,"mini_excavator, 2800kg"
DOOSAN,DX300-5,2015,2020,Doosan DL08,DHKCET0001,DHKCET9999,"excavator, 30000kg"
DOOSAN,DX300LC-7,2020,,Doosan DL08P,DHKCES0001,DHKCES9999,"excavator, 30500kg"
DOOSAN,DX340-5,2015,2020,Doosan DL08,DHKCEV0001,DHKCEV9999,"excavator, 34000kg"
DOOSAN,DX340LC-7,2020,,Doosan DL08P,DHKCEU0001,DHKCEU9999,"excavator, 34500kg"
DOOSAN,DX35Z,2018,,Yanmar 3TNV88F,DHKCED0001,DHKCED9999,"mini_excavator, 3600kg"
DOOSAN,DX380LC-7,2020,,Scania DC09,DHKCEW0001,DHKCEW9999,"excavator, 38500kg"
DOOSAN,DX420-5,2015,2020,Scania DC09,DHKCEY0001,DHKCEY9999,"excavator, 42000kg"
DOOSAN,DX420LC-7,2020,,Scania DC09,DHKCEX0001,DHKCEX9999,"excavator, 42500kg"
DOOSAN,DX42-5,2018,,Yanmar 4TNV88,DHKCEE0001,DHKCEE9999,"mini_excavator, 4300kg"
DOOSAN,DX490LC-7,2020,,Scania DC13,DHKCEZ0001,DHKCEZ9999,"excavator, 49500kg"
DOOSAN,DX50Z-7,2020,,Yanmar 4TNV98,DHKCEF0001,DHKCEF9999,"mini_excavator, 5100kg"
DOOSAN,DX520-5,2015,2020,Scania DC13,DHKCFB0001,DHKCFB9999,"excavator, 52000kg"
DOOSAN,DX520LC-7,2020,,Scania DC13,DHKCFA0001,DHKCFA9999,"excavator, 52500kg"
DOOSAN,DX55-7,2020,,Yanmar 4TNV98,DHKCEG0001,DHKCEG9999,"mini_excavator, 5600kg"
DOOSAN,DX62R-7,2020,,Yanmar 4TNV98,DHKCEH0001,DHKCEH9999,"excavator, 6300kg"
DOOSAN,DX800LC-7,2020,,Scania DC16,DHKCFC0001,DHKCFC5000,"excavator, 80000kg"
DOOSAN,DX85R-7,2020,,Doosan D24,DHKCEJ0001,DHKCEJ9999,"excavator, 8600kg"
FIAT-HITACHI,EX135,1995,2005,Fiat-Iveco 8045,FHEX135A01,FHEX135A99,"excavator, 14000kg"
FIAT-HITACHI,EX165,1995,2005,Fiat-Iveco 8065,FHEX165A01,FHEX165A99,"excavator, 17000kg"
FIAT-HITACHI,EX215,1995,2005,Fiat-Iveco 8065,FHEX215A01,FHEX215A99,"excavator, 22000kg"
FIAT-HITACHI,EX255,1995,2005,Fiat-Iveco 8210,FHEX255A01,FHEX255A99,"excavator, 26000kg"
FIAT-HITACHI,EX285,1995,2005,Fiat-Iveco 8210,FHEX285A01,FHEX285A99,"excavator, 29000kg"
FIAT-HITACHI,EX355,1995,2005,Fiat-Iveco 8210,FHEX355A01,FHEX355A99,"excavator, 36000kg"
FIAT-HITACHI,EX455,1995,2005,Fiat-Iveco 8280,FHEX455A01,FHEX455A99,"excavator, 46000kg"
FIAT-HITACHI,FH130,2000,2005,Iveco NEF,FHFH130A01,FHFH130A99,"excavator, 13500kg"
FIAT-HITACHI,FH150,2000,2005,Iveco NEF,FHFH150A01,FHFH150A99,"excavator, 15500kg"
FIAT-HITACHI,FH200,2000,2005,Iveco NEF,FHFH200A01,FHFH200A99,"excavator, 20500kg"
FIAT-HITACHI,FH220,2000,2005,Iveco Cursor,FHFH220A01,FHFH220A99,"excavator, 22500kg"
FIAT-HITACHI,FH270,2000,2005,Iveco Cursor,FHFH270A01,FHFH270A99,"excavator, 27500kg"
FIAT-HITACHI,FH300,2000,2005,Iveco Cursor,FHFH300A01,FHFH300A99,"excavator, 30500kg"
FIAT-HITACHI,FH330,2000,2005,Iveco Cursor,FHFH330A01,FHFH330A99,"excavator, 33500kg"
FIAT-HITACHI,FH450,2000,2005,Iveco Cursor,FHFH450A01,FHFH450A99,"excavator, 45500kg"
FIAT-HITACHI,FR130,2000,2005,Iveco NEF,FHFR130A01,FHFR130A99,"wheel_loader, 11500kg"
FIAT-HITACHI,FR160,2000,2005,Iveco NEF,FHFR160A01,FHFR160A99,"wheel_loader, 14500kg"
FIAT-HITACHI,FR220,2000,2005,Iveco Cursor,FHFR220A01,FHFR220A99,"wheel_loader, 20000kg"
FIAT-HITACHI,W130,1995,2005,Fiat-Iveco 8065,FHW130A001,FHW130A999,"wheel_loader, 11000kg"
FIAT-HITACHI,W170,1995,2005,Fiat-Iveco 8210,FHW170A001,FHW170A999,"wheel_loader, 15000kg"
FIAT-HITACHI,W190,1995,2005,Fiat-Iveco 8210,FHW190A001,FHW190A999,"wheel_loader, 17500kg"
FIAT-HITACHI,W230,1995,2005,Fiat-Iveco 8280,FHW230A001,FHW230A999,"wheel_loader, 21000kg"
FIAT-HITACHI,W270,1995,2005,Fiat-Iveco 8280,FHW270A001,FHW270A999,"wheel_loader, 25000kg"
FIAT-KOBELCO,E135SR,2002,2007,Iveco NEF,FKE135A001,FKE135A999,"excavator, 14000kg"
FIAT-KOBELCO,E145W,2002,2007,Iveco NEF,FKE145A001,FKE145A999,"wheeled_excavator, 15000kg"
FIAT-KOBELCO,E165,2002,2007,Iveco NEF,FKE165A001,FKE165A999,"excavator, 17000kg"
FIAT-KOBELCO,E175W,2002,2007,Iveco Cursor,FKE175A001,FKE175A999,"wheeled_excavator, 18000kg"
FIAT-KOBELCO,E195,2002,2007,Iveco Cursor,FKE195A001,FKE195A999,"excavator, 20000kg"
FIAT-KOBELCO,E215,2002,2007,Iveco Cursor,FKE215A001,FKE215A999,"excavator, 22000kg"
FIAT-KOBELCO,E235SR,2002,2007,Iveco Cursor,FKE235A001,FKE235A999,"excavator, 24000kg"
FIAT-KOBELCO,E265,2002,2007,Iveco Cursor,FKE265A001,FKE265A999,"excavator, 27000kg"
FIAT-KOBELCO,E305,2002,2007,Iveco Cursor,FKE305A001,FKE305A999,"excavator, 31000kg"
FIAT-KOBELCO,E385,2002,2007,Iveco Cursor,FKE385A001,FKE385A999,"excavator, 39000kg"
FIAT-KOBELCO,E505,2002,2007,Iveco Cursor,FKE505A001,FKE505A999,"excavator, 51000kg"
FIAT-KOBELCO,E80,2002,2007,Iveco NEF,FKE80A0001,FKE80A9999,"excavator, 8500kg"
HITACHI,ZW100-6,2015,,Isuzu 4JJ1X,HCWAA01001,HCWAA09999,"wheel_loader, 7500kg"
HITACHI,ZW140-6,2015,,Isuzu 4HK1X,HCWAB01001,HCWAB09999,"wheel_loader, 10000kg"
HITACHI,ZW180-6,2015,,Isuzu 4HK1X,HCWAC01001,HCWAC09999,"wheel_loader, 13000kg"
HITACHI,ZW220-6,2015,,Isuzu 6HK1X,HCWAD01001,HCWAD09999,"wheel_loader, 16000kg"
HITACHI,ZW250-6,2015,,Isuzu 6HK1X,HCWAE01001,HCWAE09999,"wheel_loader, 18500kg"
HITACHI,ZW310-6,2015,,Isuzu 6WG1X,HCWAF01001,HCWAF09999,"wheel_loader, 22000kg"
HITACHI,ZW370-6,2015,,Isuzu 6WG1X,HCWAG01001,HCWAG09999,"wheel_loader, 27000kg"
HITACHI,ZX130-7,2020,,Isuzu 4HK1X,HCMBJ01001,HCMBJ09999,"excavator, 13500kg"
HITACHI,ZX135US-7,2020,,Isuzu 4HK1X,HCMBK01001,HCMBK09999,"excavator, 14000kg"
HITACHI,ZX160LC-7,2020,,Isuzu 4HK1X,HCMBL01001,HCMBL09999,"excavator, 16500kg"
HITACHI,ZX17U-6,2019,,Yanmar 3TNV70,HCMAA01001,HCMAA09999,"mini_excavator, 1700kg"
HITACHI,ZX200-6,2015,2020,Isuzu 4HK1X,HCMBN01001,HCMBN09999,"excavator, 20000kg"
HITACHI,ZX200-7,2020,,Isuzu 4HK1X,HCMBM01001,HCMBM09999,"excavator, 20500kg"
HITACHI,ZX210-7,2020,,Isuzu 4HK1X,HCMBP01001,HCMBP09999,"excavator, 21500kg"
HITACHI,ZX225US-7,2020,,Isuzu 4HK1X,HCMBR01001,HCMBR09999,"excavator, 23000kg"
HITACHI,ZX250LC-7,2020,,Isuzu 6HK1X,HCMBS01001,HCMBS09999,"excavator, 25500kg"
HITACHI,ZX26U-6,2019,,Yanmar 3TNV80F,HCMAB01001,HCMAB09999,"mini_excavator, 2700kg"
HITACHI,ZX290LC-7,2020,,Isuzu 6HK1X,HCMBT01001,HCMBT09999,"excavator, 29500kg"
HITACHI,ZX300LC-7,2020,,Isuzu 6HK1X,HCMBU01001,HCMBU09999,"excavator, 30500kg"
HITACHI,ZX330-6,2015,2020,Isuzu 6HK1X,HCMBW01001,HCMBW09999,"excavator, 33000kg"
HITACHI,ZX330-7,2020,,Isuzu 6HK1X,HCMBV01001,HCMBV09999,"excavator, 33500kg"
HITACHI,ZX33U-6,2019,,Yanmar 3TNV88F,HCMAC01001,HCMAC09999,"mini_excavator, 3400kg"
HITACHI,ZX350-6,2015,2020,Isuzu 6WG1X,HCMBY01001,HCMBY09999,"excavator, 35000kg"
HITACHI,ZX350LC-7,2020,,Isuzu 6WG1X,HCMBX01001,HCMBX09999,"excavator, 35500kg"
HITACHI,ZX380LC-7,2020,,Isuzu 6WG1X,HCMBZ01001,HCMBZ09999,"excavator, 38500kg"
HITACHI,ZX38U-6,2019,,Yanmar 3TNV88F,HCMAD01001,HCMAD09999,"mini_excavator, 3900kg"
HITACHI,ZX470-6,2015,2020,Isuzu 6WG1X,HCMCB01001,HCMCB09999,"excavator, 47000kg"
HITACHI,ZX470LC-7,2020,,Isuzu 6WG1X,HCMCA01001,HCMCA09999,"excavator, 47500kg"
HITACHI,ZX48U-6,2019,,Yanmar 4TNV88,HCMAE01001,HCMAE09999,"mini_excavator, 4800kg"
HITACHI,ZX490LCH-7,2020,,Isuzu 6WG1X,HCMCC01001,HCMCC09999,"excavator, 49500kg"
HITACHI,ZX530LCH-7,2020,,Isuzu 6WG1X,HCMCD01001,HCMCD09999,"excavator, 53500kg"
HITACHI,ZX55U-6,2019,,Yanmar 4TNV98,HCMAF01001,HCMAF09999,"mini_excavator, 5500kg"
HITACHI,ZX65USB-6,2019,,Yanmar 4TNV98,HCMAG01001,HCMAG09999,"excavator, 6500kg"
HITACHI,ZX670LC-6,2015,,Isuzu 6WG1X,HCMCE01001,HCMCE05000,"excavator, 67000kg"
HITACHI,ZX85USB-6,2019,,Isuzu 4LE2X,HCMAH01001,HCMAH09999,"excavator, 8500kg"
HITACHI,ZX870LC-6,2015,,Isuzu 6WG1X,HCMCF01001,HCMCF03000,"excavator, 87000kg"
JCB,100C-2,2018,,JCB Dieselmax,JCB100C2A001,JCB100C2A999,"excavator, 10500kg"
JCB,131X,2020,,JCB Dieselmax,JCB131XA0001,JCB131XA9999,"excavator, 13500kg"
JCB,140X,2020,,JCB Dieselmax,JCB140XA0001,JCB140XA9999,"excavator, 14500kg"
JCB,150X,2020,,JCB Dieselmax,JCB150XA0001,JCB150XA9999,"excavator, 15500kg"
JCB,1CX,2010,,Perkins 404D-22,JCB1CXA00001,JCB1CXA99999,"backhoe_loader, 2500kg"
JCB,220X,2020,,JCB Dieselmax,JCB220XA0001,JCB220XA9999,"excavator, 22000kg"
JCB,2CX,2010,,JCB Dieselmax,JCB2CXA00001,JCB2CXA99999,"backhoe_loader, 4500kg"
JCB,3CX,1980,,JCB Dieselmax,JCB3CXA00001,JCB3CXA99999,"backhoe_loader, 8000kg"
JCB,3CX Compact,2015,,JCB Dieselmax,JCB3CXC00001,JCB3CXC99999,"backhoe_loader, 6500kg"
JCB,48Z-1,2018,,JCB by Kohler,JCB48Z1A0001,JCB48Z1A9999,"mini_excavator, 4800kg"
JCB,4CX,1992,,JCB Dieselmax,JCB4CXA00001,JCB4CXA99999,"backhoe_loader, 9500kg"
JCB,4CX Super,2010,,JCB Dieselmax,JCB4CXS00001,JCB4CXS99999,"backhoe_loader, 10000kg"
JCB,525-60,2015,,JCB Dieselmax,JCB52560A001,JCB52560A999,"telehandler, 5500kg"
JCB,531-70,2015,,JCB Dieselmax,JCB53170A001,JCB53170A999,"telehandler, 7000kg"
JCB,535-95,2015,,JCB Dieselmax,JCB53595A001,JCB53595A999,"telehandler, 9500kg"
JCB,540-140,2015,,JCB Dieselmax,JCB540140A01,JCB540140A99,"telehandler, 11000kg"
JCB,540-170,2015,,JCB Dieselmax,JCB540170A01,JCB540170A99,"telehandler, 12500kg"
JCB,540-200,2015,,JCB Dieselmax,JCB540200A01,JCB540200A99,"telehandler, 14000kg"
JCB,550-80,2015,,JCB Dieselmax,JCB55080A001,JCB55080A999,"telehandler, 10500kg"
JCB,55Z-1,2018,,JCB by Kohler,JCB55Z1A0001,JCB55Z1A9999,"mini_excavator, 5500kg"
JCB,560-80,2015,,JCB Dieselmax,JCB56080A001,JCB56080A999,"telehandler, 12000kg"
JCB,5CX,2015,,JCB Dieselmax,JCB5CXA00001,JCB5CXA99999,"backhoe_loader, 11000kg"
JCB,65R-1,2018,,JCB by Kohler,JCB65R1A0001,JCB65R1A9999,"excavator, 6500kg"
JCB,8008 CTS,2015,,Perkins 403D-11,JCB8008A0001,JCB8008A9999,"mini_excavator, 950kg"
JCB,8010 CTS,2015,,Perkins 403D-11,JCB8010A0001,JCB8010A9999,"mini_excavator, 1100kg"
JCB,8014 CTS,2015,,Perkins 403D-15,JCB8014A0001,JCB8014A9999,"mini_excavator, 1500kg"
JCB,8018 CTS,2015,,Perkins 403D-15,JCB8018A0001,JCB8018A9999,"mini_excavator, 1800kg"
JCB,8025 ZTS,2015,,Perkins 403J-17,JCB8025A0001,JCB8025A9999,"mini_excavator, 2700kg"
JCB,8030 ZTS,2015,,Perkins 403J-17,JCB8030A0001,JCB8030A9999,"mini_excavator, 3200kg"
JCB,8035 ZTS,2015,,Perkins 404D-22,JCB8035A0001,JCB8035A9999,"mini_excavator, 3700kg"
JCB,85Z-1,2018,,JCB Dieselmax,JCB85Z1A0001,JCB85Z1A9999,"excavator, 8500kg"
JCB,86C-2,2018,,JCB Dieselmax,JCB86C2A0001,JCB86C2A9999,"excavator, 8600kg"
JCB,JS130,2010,2020,Isuzu 4HK1X,JCBJS130A001,JCBJS130A999,"excavator, 13000kg"
JCB,JS145,2010,2020,Isuzu 4HK1X,JCBJS145A001,JCBJS145A999,"excavator, 14500kg"
JCB,JS160,2010,2020,Isuzu 4HK1X,JCBJS160A001,JCBJS160A999,"excavator, 16500kg"
JCB,JS200,2010,2020,Isuzu 4HK1X,JCBJS200A001,JCBJS200A999,"excavator, 20500kg"
JCB,JS205,2015,,JCB Dieselmax,JCBJS205A001,JCBJS205A999,"excavator, 21000kg"
JCB,JS220,2010,2020,Isuzu 6HK1X,JCBJS220A001,JCBJS220A999,"excavator, 22500kg"
JCB,JS300,2010,2020,Isuzu 6HK1X,JCBJS300A001,JCBJS300A999,"excavator, 30500kg"
JCB,JS330,2010,2020,Isuzu 6WG1X,JCBJS330A001,JCBJS330A999,"excavator, 33500kg"
JCB,JS370,2010,2020,Isuzu 6WG1X,JCBJS370A001,JCBJS370A999,"excavator, 37500kg"
JCB,JS500,2010,,MTU 6R1000,JCBJS500A001,JCBJS500A500,"excavator, 50000kg"
KOBELCO,SK140SRLC-7,2020,,Isuzu 4HK1X,YN14-00001,YN14-09999,"excavator, 14500kg"
KOBELCO,SK17SR-5,2018,,Yanmar 3TNV70,PW08-00001,PW08-09999,"mini_excavator, 1700kg"
KOBELCO,SK210LC-10,2018,,Hino J05E,YQ11-00001,YQ11-09999,"excavator, 21500kg"
KOBELCO,SK230SRLC-5,2018,,Hino J05E,YQ13-00001,YQ13-09999,"excavator, 23500kg"
KOBELCO,SK260LC-10,2018,,Hino J08E,YQ14-00001,YQ14-09999,"excavator, 26500kg"
KOBELCO,SK26SR-6,2018,,Yanmar 3TNV82A,PW26A00001,PW26A09999,"mini_excavator, 2700kg"
KOBELCO,SK300LC-10,2018,,Hino J08E,YQ15-00001,YQ15-09999,"excavator, 30500kg"
KOBELCO,SK30SR-6,2018,,Yanmar 3TNV88F,PW12-00001,PW12-09999,"mini_excavator, 3100kg"
KOBELCO,SK350LC-10,2018,,Hino J08E,YQ16-00001,YQ16-09999,"excavator, 35500kg"
KOBELCO,SK35SR-6,2018,,Yanmar 3TNV88F,PW13-00001,PW13-09999,"mini_excavator, 3600kg"
KOBELCO,SK380XDLC-10,2018,,Hino A09C,YQ17-00001,YQ17-09999,"excavator, 38500kg"
KOBELCO,SK500LC-10,2018,,Hino A09C,YQ19-00001,YQ19-09999,"excavator, 50500kg"
KOBELCO,SK520LC-10,2018,,Hino A09C,YQ22-00001,YQ22-09999,"excavator, 52500kg"
KOBELCO,SK55SRX-6,2018,,Yanmar 4TNV98,PX15-00001,PX15-09999,"mini_excavator, 5500kg"
KOBELCO,SK75SR-7,2020,,Yanmar 4TNV98,YN12-00001,YN12-09999,"excavator, 7500kg"
KOBELCO,SK850LC-10E,2018,,Hino E13C,YQ21-00001,YQ21-05000,"excavator, 85000kg"
KOBELCO,SK85MSR-7,2020,,Isuzu 4LE2X,YN13-00001,YN13-09999,"excavator, 8500kg"
KOMATSU,D155AX-8,2015,,Komatsu SAA6D140E-7,90001,92000,"dozer, 40000kg"
KOMATSU,D275AX-5,2008,,Komatsu SAA12V140E-3,30001,31000,"dozer, 55000kg"
KOMATSU,D31PX-22,2012,,Komatsu SAA4D95LE-5,60001,65000,"dozer, 6500kg"
KOMATSU,D375A-8,2015,,Komatsu SAA12V140E-3,20001,29999,"dozer, 73000kg"`;

class MedusaService {
  private machines: Machine[] = [];
  private initialized = false;

  async init() {
    if (this.initialized) return;

    try {
      const stored = localStorage.getItem(STORAGE_KEY);
      if (stored) {
        this.machines = JSON.parse(stored);
        this.initialized = true;
        return;
      }
    } catch (e) {
      console.warn("Local storage corrupted or outdated, reloading from CSV.", e);
      localStorage.removeItem(STORAGE_KEY);
    }

    this.machines = this.parseCSV(RAW_CSV_DATA);
    this.save();
    this.initialized = true;
  }

  parseCSV(csv: string): Machine[] {
    const lines = csv.split('\n').filter(line => line.trim().length > 0);
    // Assume first line is header, skip it
    return lines.slice(1).map((line, index) => {
        // Robust CSV parsing for lines like: DATA,DATA,"QUOTED, DATA"
        const parts: string[] = [];
        let current = '';
        let inQuote = false;
        
        for (let i = 0; i < line.length; i++) {
            const char = line[i];
            if (char === '"') {
                inQuote = !inQuote;
            } else if (char === ',' && !inQuote) {
                parts.push(current.trim());
                current = '';
            } else {
                current += char;
            }
        }
        parts.push(current.trim());

        // Destructure based on known CSV structure:
        // manufacturer,model_code,year_from,year_to,engine_model,serial_range_start,serial_range_end,notes
        const [manufacturer, model_code, year_from, year_to, engine_model, serial_range_start, serial_range_end, notes] = parts;

        const safeId = `${manufacturer}-${model_code}-${index}`.replace(/[^a-zA-Z0-9-]/g, '').toLowerCase();

        return {
            id: safeId,
            basicInfo: {
                manufacturer: manufacturer || 'Unknown',
                model_code: model_code || 'Unknown',
                year_from: year_from || '',
                year_to: year_to || '',
                serial_range_start: serial_range_start || '',
                serial_range_end: serial_range_end || '',
                type_weight_note: notes ? notes.replace(/^"|"$/g, '') : '',
                engine_model: engine_model || ''
            },
            ratingPlate: {
                operatingweightkg: "", enginepowerkw: "", engine_model: engine_model || "", enginedisplacementcc: "",
                emission_standard: "", hydraulicpressurebar: "", fueltankcapacity_l: "", hydraulictankcapacity_l: "",
                coolantcapacityl: "", engineoilcapacity_l: "", adblue_capacity_l: ""
            },
            mechanicalSpecs: {
                max_torque_nm: "", hydraulic_pump_type: "", hydraulic_flow_max_lmin: "", system_voltage_v: "",
                battery_capacity_ah: "", travel_speed_kmh: "", swing_speed_rpm: "", breakout_force_kn: ""
            },
            dimensions: {
                transport_length_mm: "", transport_width_mm: "", transport_height_mm: "", digging_depth_mm: "",
                digging_reach_mm: "", dump_height_mm: ""
            },
            soundSpecs: { noise_level_external_lwa_db: "", noise_level_cabin_lpa_db: "" },
            commonIssues: [],
            partsCatalog: [],
            raw: {
                notes: notes || '',
                specifications: `${manufacturer} ${model_code}`,
                applications: "", maintenance: "", oem_parts_raw: "", notes_pl: "", diagnostics_raw: ""
            }
        };
    });
  }

  async getMachines(): Promise<Machine[]> {
    await this.init();
    return this.machines;
  }

  async addMachine(machine: Machine): Promise<void> {
    await this.init();
    this.machines.unshift(machine);
    this.save();
  }

  async updateMachine(updatedMachine: Machine): Promise<void> {
      await this.init();
      const index = this.machines.findIndex(m => m.id === updatedMachine.id);
      if (index !== -1) {
          this.machines[index] = updatedMachine;
          this.save();
      }
  }

  private save() {
    try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(this.machines));
    } catch (e) {
        console.error("Failed to save to localStorage (quota exceeded?)", e);
    }
  }
}

export const medusaService = new MedusaService();
